import {
  Component,
  EventEmitter,
  Output,
  signal,
  ChangeDetectionStrategy,
  OnInit,
  computed,
} from '@angular/core';
import { CommonModule } from '@angular/common';
import { MatIconModule } from '@angular/material/icon';
import { MatButtonModule } from '@angular/material/button';
import { MatTabsModule } from '@angular/material/tabs';

interface EmojiCategory {
  name: string;
  icon: string;
  emojis: string[];
}

@Component({
  selector: 'app-emoji-picker',
  imports: [CommonModule, MatIconModule, MatButtonModule, MatTabsModule],
  templateUrl: './emoji-picker.html',
  styleUrl: './emoji-picker.css',
  changeDetection: ChangeDetectionStrategy.OnPush,
})
export class EmojiPicker implements OnInit {
  @Output() emojiSelect = new EventEmitter<string>();

  private readonly RECENT_KEY = 'recent_emojis';
  private readonly MAX_RECENT = 24;

  recentEmojis = signal<string[]>([]);

  allCategories = signal<EmojiCategory[]>([
    {
      name: 'Smileys',
      icon: 'mood',
      emojis: [
        'ðŸ˜€',
        'ðŸ˜ƒ',
        'ðŸ˜„',
        'ðŸ˜',
        'ðŸ˜†',
        'ðŸ˜…',
        'ðŸ˜‚',
        'ðŸ¤£',
        'ðŸ˜Š',
        'ðŸ˜‡',
        'ðŸ™‚',
        'ðŸ™ƒ',
        'ðŸ˜‰',
        'ðŸ˜Œ',
        'ðŸ˜',
        'ðŸ¥°',
        'ðŸ˜˜',
        'ðŸ˜—',
        'ðŸ˜™',
        'ðŸ˜š',
        'ðŸ˜‹',
        'ðŸ˜›',
        'ðŸ˜',
        'ðŸ˜œ',
        'ðŸ¤ª',
        'ðŸ¤¨',
        'ðŸ§',
        'ðŸ¤“',
        'ðŸ˜Ž',
        'ðŸ¤©',
        'ðŸ¥³',
        'ðŸ˜',
        'ðŸ˜’',
        'ðŸ˜ž',
        'ðŸ˜”',
        'ðŸ˜Ÿ',
        'ðŸ˜•',
        'ðŸ™',
        'â˜¹ï¸',
        'ðŸ˜£',
        'ðŸ˜–',
        'ðŸ˜«',
        'ðŸ˜©',
        'ðŸ¥º',
        'ðŸ˜¢',
        'ðŸ˜­',
        'ðŸ˜¤',
        'ðŸ˜ ',
        'ðŸ˜¡',
        'ðŸ¤¬',
        'ðŸ¤¯',
        'ðŸ˜³',
        'ðŸ¥µ',
        'ðŸ¥¶',
        'ðŸ˜±',
        'ðŸ˜¨',
        'ðŸ˜°',
        'ðŸ˜¥',
        'ðŸ˜“',
        'ðŸ¤—',
        'ðŸ¤”',
        'ðŸ¤­',
        'ðŸ¤«',
        'ðŸ¤¥',
        'ðŸ˜¶',
        'ðŸ˜',
        'ðŸ˜‘',
        'ðŸ˜¬',
        'ðŸ™„',
        'ðŸ˜¯',
        'ðŸ˜¦',
        'ðŸ˜§',
        'ðŸ˜®',
        'ðŸ˜²',
        'ðŸ¥±',
        'ðŸ˜´',
        'ðŸ¤¤',
        'ðŸ˜ª',
        'ðŸ˜µ',
        'ðŸ¤',
        'ðŸ¥´',
        'ðŸ¤¢',
        'ðŸ¤®',
        'ðŸ¤§',
        'ðŸ˜·',
        'ðŸ¤’',
        'ðŸ¤•',
      ],
    },
    {
      name: 'Animals',
      icon: 'pets',
      emojis: [
        'ðŸ¶',
        'ðŸ±',
        'ðŸ­',
        'ðŸ¹',
        'ðŸ°',
        'ðŸ¦Š',
        'ðŸ»',
        'ðŸ¼',
        'ðŸ¨',
        'ðŸ¯',
        'ðŸ¦',
        'ðŸ®',
        'ðŸ·',
        'ðŸ½',
        'ðŸ¸',
        'ðŸµ',
        'ðŸ™ˆ',
        'ðŸ™‰',
        'ðŸ™Š',
        'ðŸ’',
        'ðŸ”',
        'ðŸ§',
        'ðŸ¦',
        'ðŸ¤',
        'ðŸ£',
        'ðŸ¥',
        'ðŸ¦†',
        'ðŸ¦…',
        'ðŸ¦‰',
        'ðŸ¦‡',
        'ðŸº',
        'ðŸ—',
        'ðŸ´',
        'ðŸ¦„',
        'ðŸ',
        'ðŸ›',
        'ðŸ¦‹',
        'ðŸŒ',
        'ðŸž',
        'ðŸœ',
        'ðŸ¦Ÿ',
        'ðŸ¦—',
        'ðŸ•·',
        'ðŸ•¸',
        'ðŸ¦‚',
        'ðŸ¢',
        'ðŸ',
        'ðŸ¦Ž',
        'ðŸ¦–',
        'ðŸ¦•',
        'ðŸ™',
        'ðŸ¦‘',
        'ðŸ¦',
        'ðŸ¦ž',
        'ðŸ¦€',
        'ðŸ¡',
        'ðŸ ',
        'ðŸŸ',
        'ðŸ¬',
        'ðŸ³',
        'ðŸ‹',
        'ðŸ¦ˆ',
        'ðŸŠ',
        'ðŸ…',
        'ðŸ†',
        'ðŸ¦“',
        'ðŸ¦',
        'ðŸ¦§',
        'ðŸ˜',
        'ðŸ¦›',
        'ðŸ¦',
        'ðŸª',
        'ðŸ«',
        'ðŸ¦’',
        'ðŸ¦˜',
        'ðŸƒ',
        'ðŸ‚',
        'ðŸ„',
        'ðŸŽ',
        'ðŸ–',
        'ðŸ',
        'ðŸ‘',
        'ðŸ¦™',
        'ðŸ',
        'ðŸ¦Œ',
        'ðŸ•',
        'ðŸ©',
        'ðŸ¦®',
        'ðŸ•â€ðŸ¦º',
        'ðŸˆ',
        'ðŸ“',
        'ðŸ¦ƒ',
        'ðŸ¦š',
        'ðŸ¦œ',
        'ðŸ¦¢',
        'ðŸ¦©',
        'ðŸ•Š',
        'ðŸ‡',
        'ðŸ¦',
        'ðŸ¦¨',
        'ðŸ¦¡',
        'ðŸ¦¦',
        'ðŸ¦¥',
        'ðŸ',
        'ðŸ€',
        'ðŸ¿',
        'ðŸ¦”',
      ],
    },
    {
      name: 'Food',
      icon: 'restaurant',
      emojis: [
        'ðŸ',
        'ðŸŽ',
        'ðŸ',
        'ðŸŠ',
        'ðŸ‹',
        'ðŸŒ',
        'ðŸ‰',
        'ðŸ‡',
        'ðŸ“',
        'ðŸˆ',
        'ðŸ’',
        'ðŸ‘',
        'ðŸ¥­',
        'ðŸ',
        'ðŸ¥¥',
        'ðŸ¥',
        'ðŸ…',
        'ðŸ†',
        'ðŸ¥‘',
        'ðŸ¥¦',
        'ðŸ¥¬',
        'ðŸ¥’',
        'ðŸŒ½',
        'ðŸ¥•',
        'ðŸ§„',
        'ðŸ§…',
        'ðŸ¥”',
        'ðŸ ',
        'ðŸ¥',
        'ðŸ¥¯',
        'ðŸž',
        'ðŸ¥–',
        'ðŸ¥¨',
        'ðŸ§€',
        'ðŸ¥š',
        'ðŸ³',
        'ðŸ§ˆ',
        'ðŸ¥ž',
        'ðŸ§‡',
        'ðŸ¥“',
        'ðŸ¥©',
        'ðŸ—',
        'ðŸ–',
        'ðŸ¦´',
        'ðŸŒ­',
        'ðŸ”',
        'ðŸŸ',
        'ðŸ•',
        'ðŸ¥ª',
        'ðŸ¥™',
        'ðŸ§†',
        'ðŸŒ®',
        'ðŸŒ¯',
        'ðŸ¥—',
        'ðŸ¥˜',
        'ðŸ',
        'ðŸœ',
        'ðŸ²',
        'ðŸ›',
        'ðŸ£',
        'ðŸ±',
        'ðŸ¥Ÿ',
        'ðŸ¦ª',
        'ðŸ¤',
        'ðŸ™',
        'ðŸš',
        'ðŸ˜',
        'ðŸ¥',
        'ðŸ¥ ',
        'ðŸ¥®',
        'ðŸ¢',
        'ðŸ¡',
        'ðŸ§',
        'ðŸ¨',
        'ðŸ¦',
        'ðŸ¥§',
        'ðŸ§',
        'ðŸ°',
        'ðŸŽ‚',
        'ðŸ®',
        'ðŸ­',
        'ðŸ¬',
        'ðŸ«',
        'ðŸ¿',
        'ðŸ©',
        'ðŸª',
        'ðŸŒ°',
        'ðŸ¥œ',
        'ðŸ¯',
      ],
    },
    {
      name: 'Activities',
      icon: 'directions_run',
      emojis: [
        'âš½ï¸',
        'ðŸ€',
        'ðŸˆ',
        'âš¾ï¸',
        'ðŸ¥Ž',
        'ðŸŽ¾',
        'ðŸ',
        'ðŸ‰',
        'ðŸ¥',
        'ðŸŽ±',
        'ðŸª€',
        'ðŸ“',
        'ðŸ¸',
        'ðŸ’',
        'ðŸ‘',
        'ðŸ¥',
        'ðŸ¹',
        'ðŸŽ£',
        'ðŸ¤¿',
        'ðŸ¥Š',
        'ðŸ¥‹',
        'â›¸',
        'ðŸŽ¿',
        'ðŸ›·',
        'ðŸ¥Œ',
        'ðŸŽ¯',
        'ðŸª€',
        'ðŸª',
        'ðŸ”®',
        'ðŸ§¿',
        'ðŸŽ®',
        'ðŸ•¹',
        'ðŸŽ°',
        'ðŸŽ²',
        'ðŸ§©',
        'ðŸ§¸',
        'â™ ï¸',
        'â™¥ï¸',
        'â™¦ï¸',
        'â™£ï¸',
        'â™Ÿ',
        'ðŸƒ',
        'ðŸ€„ï¸',
        'ðŸŽ´',
        'ðŸŽ­',
        'ðŸ–¼',
        'ðŸŽ¨',
        'ðŸ§µ',
        'ðŸ§¶',
      ],
    },
    {
      name: 'Travel',
      icon: 'flight',
      emojis: [
        'ðŸš—',
        'ðŸš•',
        'ðŸš™',
        'ðŸšŒ',
        'ðŸšŽ',
        'ðŸŽ',
        'ðŸš“',
        'ðŸš‘',
        'ðŸš’',
        'ðŸš',
        'ðŸšš',
        'ðŸš›',
        'ðŸšœ',
        'ðŸ¦¯',
        'ðŸ¦½',
        'ðŸ¦¼',
        'ðŸ›´',
        'ðŸš²',
        'ðŸ›µ',
        'ðŸ',
        'ðŸ›º',
        'ðŸš¨',
        'ðŸš”',
        'ðŸš',
        'ðŸš˜',
        'ðŸš–',
        'ðŸš–',
        'ðŸš ',
        'ðŸšŸ',
        'ðŸšƒ',
        'ðŸš‹',
        'ðŸšž',
        'ðŸš',
        'ðŸš„',
        'ðŸš…',
        'ðŸšˆ',
        'ðŸš‚',
        'ðŸš†',
        'ðŸš‡',
        'ðŸšŠ',
        'ðŸš‰',
        'âœˆï¸',
        'ðŸ›«',
        'ðŸ›¬',
        'ðŸ›©',
        'ðŸ’º',
        'ðŸ›°',
        'ðŸš€',
        'ðŸ›¸',
        'ðŸš',
        'ðŸ›¶',
        'â›µï¸',
        'ðŸš¤',
        'ðŸ›¥',
        'ðŸ›³',
        'â›´',
        'ðŸš¢',
        'âš“ï¸',
        'â›½ï¸',
        'ðŸš§',
        'ðŸ›°',
        'ðŸ—º',
        'ðŸ—¿',
        'ðŸ—½',
        'ðŸ—¼',
        'ðŸ°',
        'ðŸ¯',
        'ðŸŸ',
        'ðŸŽ¡',
        'ðŸŽ¢',
        'ðŸŽ ',
        'â›²ï¸',
        'â›±',
        'ðŸ–',
        'ðŸ',
        'ðŸœ',
        'ðŸŒ‹',
        'â›°',
        'ðŸ”',
        'ðŸ—»',
        'ðŸ•',
        'â›ºï¸',
        'ðŸ ',
        'ðŸ¡',
        'ðŸ˜',
        'ðŸš',
        'ðŸ—',
        'ðŸ­',
        'ðŸ¢',
        'ðŸ¬',
        'ðŸ£',
        'ðŸ¤',
        'ðŸ¥',
        'ðŸ¦',
        'ðŸ¨',
        'ðŸª',
        'ðŸ«',
        'ðŸ©',
        'ðŸ’’',
        'ðŸ›',
        'â›ªï¸',
        'ðŸ•Œ',
        'ðŸ•',
        'ðŸ•‹',
        'â›©',
        'ðŸ›¤',
        'ðŸ›£',
        'ðŸ—¾',
        'ðŸŽ‘',
        'ðŸž',
        'ðŸŒ…',
        'ðŸŒ…',
        'ðŸŽ‡',
        'ðŸŽ‡',
        'ðŸŒ‡',
        'ðŸŒ†',
        'ðŸ™',
        'ðŸŒƒ',
        'ðŸŒŒ',
        'ðŸŒ‰',
        'ðŸŒ',
      ],
    },
    {
      name: 'Symbols',
      icon: 'category',
      emojis: [
        'â¤ï¸',
        'ðŸ§¡',
        'ðŸ’›',
        'ðŸ’š',
        'ðŸ’™',
        'ðŸ’œ',
        'ðŸ–¤',
        'ðŸ¤',
        'ðŸ¤Ž',
        'ðŸ’”',
        'â£ï¸',
        'ðŸ’•',
        'ðŸ’ž',
        'ðŸ’“',
        'ðŸ’—',
        'ðŸ’–',
        'ðŸ’˜',
        'ðŸ’',
        'ðŸ’Ÿ',
        'â˜®ï¸',
        'âœï¸',
        'â˜ªï¸',
        'ðŸ•‰',
        'â˜¸ï¸',
        'âœ¡ï¸',
        'ðŸ”¯',
        'ðŸ•Ž',
        'â˜¯ï¸',
        'â˜¦ï¸',
        'ðŸ›',
        'â›Ž',
        'â™ˆï¸',
        'â™‰ï¸',
        'â™Šï¸',
        'â™‹ï¸',
        'â™Œï¸',
        'â™ï¸',
        'â™Žï¸',
        'â™ï¸',
        'â™ï¸',
        'â™‘ï¸',
        'â™’ï¸',
        'â™“ï¸',
        'ðŸ†”',
        'âš›ï¸',
        'ðŸ‰‘',
        'â˜¢ï¸',
        'â˜£ï¸',
        'ðŸ“´',
        'ðŸ“³',
        'ðŸˆ¶',
        'ðŸˆšï¸',
        'ðŸˆ¸',
        'ðŸˆº',
        'ðŸˆ·ï¸',
        'âœ´ï¸',
        'ðŸ†š',
        'ðŸ’®',
        'ðŸ‰',
        'ãŠ™ï¸',
        'ãŠ—ï¸',
        'ðŸˆ´',
        'ðŸˆµ',
        'ðŸˆ¹',
        'ðŸˆ²',
        'ðŸ…°ï¸',
        'ðŸ…±ï¸',
        'ðŸ†Ž',
        'ðŸ†‘',
        'ðŸ…¾ï¸',
        'ðŸ†˜',
        'âŒ',
        'â­•ï¸',
        'ðŸ›‘',
        'â›”ï¸',
        'ðŸ“›',
        'ðŸš«',
        'ðŸ’¯',
        'ðŸ’¢',
        'â™¨ï¸',
        'ðŸš·',
        'ðŸš¯',
        'ðŸš³',
        'ðŸš±',
        'ðŸ”ž',
        'ðŸ“µ',
        'ðŸš­',
        'â—ï¸',
        'â•',
        'â“',
        'â”',
        'â€¼ï¸',
        'â‰ï¸',
        'ðŸ”…',
        'ðŸ”†',
        'ã€½ï¸',
        'âš ï¸',
        'ðŸš¸',
        'ðŸ”±',
        'âšœï¸',
        'ðŸ”°',
        'â™»ï¸',
        'âœ…',
        'ðŸˆ¯ï¸',
        'ðŸ’¹',
        'â‡ï¸',
        'âœ³ï¸',
        'âŽ',
        'ðŸŒ',
        'ðŸ’ ',
        'â“‚ï¸',
        'ðŸŒ€',
        'ðŸ’¤',
        'ðŸ§',
        'ðŸš¾',
        'â™¿ï¸',
        'ðŸ…¿ï¸',
        'ðŸˆ³',
        'ðŸˆ‚ï¸',
        'ðŸ›‚',
        'ðŸ›ƒ',
        'ðŸ›„',
        'ðŸ›…',
        'ðŸš¹',
        'ðŸšº',
        'ðŸš¼',
        'âš§',
        'ðŸš»',
        'ðŸš®',
        'ðŸŽ¦',
        'ðŸ“¶',
        'ðŸˆ',
        'ðŸ†–',
        'ðŸ†—',
        'ðŸ†™',
        'ðŸ†’',
        'ðŸ†•',
        'ðŸ†“',
      ],
    },
    {
      name: 'Flags',
      icon: 'flag',
      emojis: [
        'ðŸ',
        'ðŸš©',
        'ðŸŽŒ',
        'ðŸ´',
        'ðŸ³ï¸',
        'ðŸ³ï¸â€ðŸŒˆ',
        'ðŸ³ï¸â€âš§ï¸',
        'ðŸ´â€â˜ ï¸',
        'ðŸ‡¦ðŸ‡«',
        'ðŸ‡¦ðŸ‡½',
        'ðŸ‡¦ðŸ‡±',
        'ðŸ‡©ðŸ‡¿',
        'ðŸ‡¦ðŸ‡¸',
        'ðŸ‡¦ðŸ‡©',
        'ðŸ‡¦ðŸ‡´',
        'ðŸ‡¦ðŸ‡®',
        'ðŸ‡¦ðŸ‡¶',
        'ðŸ‡¦ðŸ‡¬',
        'ðŸ‡¦ðŸ‡·',
        'ðŸ‡¦ðŸ‡²',
        'ðŸ‡¦ðŸ‡¼',
        'ðŸ‡¦ðŸ‡º',
        'ðŸ‡¦ðŸ‡¹',
        'ðŸ‡¦ðŸ‡¿',
        'ðŸ‡§ðŸ‡¸',
        'ðŸ‡§ðŸ‡­',
        'ðŸ‡§ðŸ‡©',
        'ðŸ‡§ðŸ‡§',
        'ðŸ‡§ðŸ‡¾',
        'ðŸ‡§ðŸ‡ª',
        'ðŸ‡§ðŸ‡¿',
        'ðŸ‡§ðŸ‡¯',
        'ðŸ‡§ðŸ‡²',
        'ðŸ‡§ðŸ‡¹',
        'ðŸ‡§ðŸ‡´',
        'ðŸ‡§ðŸ‡¦',
        'ðŸ‡§ðŸ‡¼',
        'ðŸ‡§ðŸ‡·',
        'ðŸ‡®ðŸ‡´',
        'ðŸ‡»ðŸ‡¬',
        'ðŸ‡§ðŸ‡³',
        'ðŸ‡§ðŸ‡¬',
        'ðŸ‡§ðŸ‡«',
        'ðŸ‡§ðŸ‡®',
        'ðŸ‡°ðŸ‡­',
        'ðŸ‡¨ðŸ‡²',
        'ðŸ‡¨ðŸ‡¦',
        'ðŸ‡®ðŸ‡¨',
        'ðŸ‡¨ðŸ‡»',
        'ðŸ‡§ðŸ‡¶',
        'ðŸ‡°ðŸ‡¾',
        'ðŸ‡¨ðŸ‡«',
        'ðŸ‡¹ðŸ‡©',
        'ðŸ‡¨ðŸ‡±',
        'ðŸ‡¨ðŸ‡³',
        'ðŸ‡¨ðŸ‡½',
        'ðŸ‡¨ðŸ‡¨',
        'ðŸ‡¨ðŸ‡´',
        'ðŸ‡°ðŸ‡²',
        'ðŸ‡¨ðŸ‡¬',
        'ðŸ‡¨ðŸ‡©',
        'ðŸ‡¨ðŸ‡°',
        'ðŸ‡¨ðŸ‡·',
        'ðŸ‡¨ðŸ‡®',
        'ðŸ‡­ðŸ‡·',
        'ðŸ‡¨ðŸ‡º',
        'ðŸ‡¨ðŸ‡¼',
        'ðŸ‡¨ðŸ‡¾',
        'ðŸ‡¨ðŸ‡¿',
        'ðŸ‡©ðŸ‡°',
        'ðŸ‡©ðŸ‡¯',
        'ðŸ‡©ðŸ‡²',
        'ðŸ‡©ðŸ‡´',
        'ðŸ‡ªðŸ‡¨',
        'ðŸ‡ªðŸ‡¬',
        'ðŸ‡¸ðŸ‡»',
        'ðŸ‡¬ðŸ‡¶',
        'ðŸ‡ªðŸ‡·',
        'ðŸ‡ªðŸ‡ª',
        'ðŸ‡ªðŸ‡¹',
        'ðŸ‡ªðŸ‡º',
        'ðŸ‡«ðŸ‡°',
        'ðŸ‡«ðŸ‡´',
        'ðŸ‡«ðŸ‡¯',
        'ðŸ‡«ðŸ‡®',
        'ðŸ‡«ðŸ‡·',
        'ðŸ‡¬ðŸ‡«',
        'ðŸ‡µðŸ‡«',
        'ðŸ‡¹ðŸ‡«',
        'ðŸ‡¬ðŸ‡¦',
        'ðŸ‡¬ðŸ‡²',
        'ðŸ‡¬ðŸ‡ª',
        'ðŸ‡©ðŸ‡ª',
        'ðŸ‡¬ðŸ‡­',
        'ðŸ‡¬ðŸ‡®',
        'ðŸ‡¬ðŸ‡·',
        'ðŸ‡¬ðŸ‡±',
        'ðŸ‡¬ðŸ‡©',
        'ðŸ‡¬ðŸ‡µ',
        'ðŸ‡¬ðŸ‡º',
        'ðŸ‡¬ðŸ‡¹',
        'ðŸ‡¬ðŸ‡¬',
        'ðŸ‡¬ðŸ‡³',
        'ðŸ‡¬ðŸ‡¼',
        'ðŸ‡¬ðŸ‡¾',
        'ðŸ‡­ðŸ‡¹',
        'ðŸ‡­ðŸ‡³',
        'ðŸ‡­ðŸ‡°',
        'ðŸ‡­ðŸ‡º',
        'ðŸ‡®ðŸ‡¸',
        'ðŸ‡®ðŸ‡³',
        'ðŸ‡®ðŸ‡©',
        'ðŸ‡®ðŸ‡·',
        'ðŸ‡®ðŸ‡¶',
        'ðŸ‡®ðŸ‡ª',
        'ðŸ‡®ðŸ‡²',
        'ðŸ‡®ðŸ‡±',
        'ðŸ‡®ðŸ‡¹',
        'ðŸ‡¯ðŸ‡²',
        'ðŸ‡¯ðŸ‡µ',
        'ðŸ‡¯ðŸ‡ª',
        'ðŸ‡¯ðŸ‡´',
        'ðŸ‡°ðŸ‡¿',
        'ðŸ‡°ðŸ‡ª',
        'ðŸ‡°ðŸ‡®',
        'ðŸ‡½ðŸ‡°',
        'ðŸ‡°ðŸ‡¼',
        'ðŸ‡°ðŸ‡¬',
        'ðŸ‡±ðŸ‡¦',
        'ðŸ‡±ðŸ‡»',
        'ðŸ‡±ðŸ‡§',
        'ðŸ‡±ðŸ‡¸',
        'ðŸ‡±ðŸ‡·',
        'ðŸ‡±ðŸ‡¾',
        'ðŸ‡±ðŸ‡®',
        'ðŸ‡±ðŸ‡¹',
        'ðŸ‡±ðŸ‡º',
        'ðŸ‡²ðŸ‡´',
        'ðŸ‡²ðŸ‡°',
        'ðŸ‡²ðŸ‡¬',
        'ðŸ‡²ðŸ‡¼',
        'ðŸ‡²ðŸ‡¾',
        'ðŸ‡²ðŸ‡»',
        'ðŸ‡²ðŸ‡±',
        'ðŸ‡²ðŸ‡¹',
        'ðŸ‡²ðŸ‡­',
        'ðŸ‡²ðŸ‡¶',
        'ðŸ‡²ðŸ‡·',
        'ðŸ‡²ðŸ‡º',
        'ðŸ‡¾ðŸ‡¹',
        'ðŸ‡²ðŸ‡½',
        'ðŸ‡«ðŸ‡²',
        'ðŸ‡²ðŸ‡©',
        'ðŸ‡²ðŸ‡¨',
        'ðŸ‡²ðŸ‡³',
        'ðŸ‡²ðŸ‡ª',
        'ðŸ‡²ðŸ‡¸',
        'ðŸ‡²ðŸ‡¦',
        'ðŸ‡²ðŸ‡¿',
        'ðŸ‡²ðŸ‡²',
        'ðŸ‡³ðŸ‡¦',
        'ðŸ‡³ðŸ‡·',
        'ðŸ‡³ðŸ‡µ',
        'ðŸ‡³ðŸ‡±',
        'ðŸ‡³ðŸ‡¨',
        'ðŸ‡³ðŸ‡¿',
        'ðŸ‡³ðŸ‡®',
        'ðŸ‡³ðŸ‡ª',
        'ðŸ‡³ðŸ‡¬',
        'ðŸ‡³ðŸ‡º',
        'ðŸ‡³ðŸ‡«',
        'ðŸ‡°ðŸ‡µ',
        'ðŸ‡²ðŸ‡µ',
        'ðŸ‡³ðŸ‡´',
        'ðŸ‡´ðŸ‡²',
        'ðŸ‡µðŸ‡°',
        'ðŸ‡µðŸ‡¼',
        'ðŸ‡µðŸ‡¸',
        'ðŸ‡µðŸ‡¦',
        'ðŸ‡µðŸ‡¬',
        'ðŸ‡µðŸ‡¾',
        'ðŸ‡µðŸ‡ª',
        'ðŸ‡µðŸ‡­',
        'ðŸ‡µðŸ‡³',
        'ðŸ‡µðŸ‡±',
        'ðŸ‡µðŸ‡¹',
        'ðŸ‡µðŸ‡·',
        'ðŸ‡¶ðŸ‡¦',
        'ðŸ‡·ðŸ‡ª',
        'ðŸ‡·ðŸ‡´',
        'ðŸ‡·ðŸ‡º',
        'ðŸ‡·ðŸ‡¼',
        'ðŸ‡¼ðŸ‡¸',
        'ðŸ‡¸ðŸ‡²',
        'ðŸ‡¸ðŸ‡¹',
        'ðŸ‡¸ðŸ‡¦',
        'ðŸ‡¸ðŸ‡³',
        'ðŸ‡·ðŸ‡¸',
        'ðŸ‡¸ðŸ‡¨',
        'ðŸ‡¸ðŸ‡±',
        'ðŸ‡¸ðŸ‡¬',
        'ðŸ‡¸ðŸ‡½',
        'ðŸ‡¸ðŸ‡°',
        'ðŸ‡¸ðŸ‡®',
        'ðŸ‡¬ðŸ‡¸',
        'ðŸ‡¸ðŸ‡§',
        'ðŸ‡¸ðŸ‡´',
        'ðŸ‡¿ðŸ‡¦',
        'ðŸ‡°ðŸ‡·',
        'ðŸ‡¸ðŸ‡¸',
        'ðŸ‡ªðŸ‡¸',
        'ðŸ‡±ðŸ‡°',
        'ðŸ‡§ðŸ‡±',
        'ðŸ‡¸ðŸ‡­',
        'ðŸ‡°ðŸ‡³',
        'ðŸ‡±ðŸ‡¨',
        'ðŸ‡µðŸ‡²',
        'ðŸ‡»ðŸ‡¨',
        'ðŸ‡¸ðŸ‡©',
        'ðŸ‡¸ðŸ‡·',
        'ðŸ‡¸ðŸ‡¿',
        'ðŸ‡¸ðŸ‡ª',
        'ðŸ‡¨ðŸ‡­',
        'ðŸ‡¸ðŸ‡¾',
        'ðŸ‡¹ðŸ‡¼',
        'ðŸ‡¹ðŸ‡¯',
        'ðŸ‡¹ðŸ‡¿',
        'ðŸ‡¹ðŸ‡­',
        'ðŸ‡¹ðŸ‡±',
        'ðŸ‡¹ðŸ‡¬',
        'ðŸ‡¹ðŸ‡°',
        'ðŸ‡¹ðŸ‡´',
        'ðŸ‡¹ðŸ‡¹',
        'ðŸ‡¹ðŸ‡³',
        'ðŸ‡¹ðŸ‡·',
        'ðŸ‡¹ðŸ‡²',
        'ðŸ‡¹ðŸ‡¨',
        'ðŸ‡¹ðŸ‡»',
        'ðŸ‡»ðŸ‡®',
        'ðŸ‡ºðŸ‡¬',
        'ðŸ‡ºðŸ‡¦',
        'ðŸ‡¦ðŸ‡ª',
        'ðŸ‡¬ðŸ‡§',
        'ðŸ´ó §ó ¢ó ¥ó ®ó §ó ¿',
        'ðŸ´ó §ó ¢ó ³ó £ó ´ó ¿',
        'ðŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿',
        'ðŸ‡ºðŸ‡³',
        'ðŸ‡ºðŸ‡¸',
        'ðŸ‡ºðŸ‡¾',
        'ðŸ‡ºðŸ‡¿',
        'ðŸ‡»ðŸ‡º',
        'ðŸ‡»ðŸ‡¦',
        'ðŸ‡»ðŸ‡ª',
        'ðŸ‡»ðŸ‡³',
        'ðŸ‡¼ðŸ‡«',
        'ðŸ‡ªðŸ‡­',
        'ðŸ‡¾ðŸ‡ª',
        'ðŸ‡¿ðŸ‡²',
        'ðŸ‡¿ðŸ‡¼',
      ],
    },
  ]);

  categories = computed(() => {
    const recent = this.recentEmojis();
    if (recent.length > 0) {
      return [
        {
          name: 'Recent',
          icon: 'history',
          emojis: recent,
        },
        ...this.allCategories(),
      ];
    }
    return this.allCategories();
  });

  ngOnInit() {
    const saved = localStorage.getItem(this.RECENT_KEY);
    if (saved) {
      try {
        this.recentEmojis.set(JSON.parse(saved));
      } catch (e) {
        console.error('Failed to parse recent emojis', e);
      }
    }
  }

  selectEmoji(emoji: string) {
    this.updateRecent(emoji);
    this.emojiSelect.emit(emoji);
  }

  private updateRecent(emoji: string) {
    this.recentEmojis.update((recent) => {
      const filtered = recent.filter((e) => e !== emoji);
      const updated = [emoji, ...filtered].slice(0, this.MAX_RECENT);
      localStorage.setItem(this.RECENT_KEY, JSON.stringify(updated));
      return updated;
    });
  }
}
